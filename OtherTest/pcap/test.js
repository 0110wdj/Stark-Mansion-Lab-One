const generator = require('pcap-generator')
const fs = require('fs')

const ipPackets = [{
  timestamp: Date.now(),
  buffer: Buffer.from([71, 69, 84, 32, 47, 32, 72, 84, 84, 80, 47, 49, 46, 49, 13, 10, 65, 99, 99, 101, 112, 116, 58, 32, 42, 47, 42, 13, 10, 65, 99, 99, 101, 115, 115, 45, 67, 111, 110, 116, 114, 111, 108, 45, 82, 101, 113, 117, 101, 115, 116, 45, 77, 101, 116, 104, 111, 100, 58, 32, 84, 104, 101, 32, 113, 117, 105, 99, 8, 8, 8, 8, 8, 8, 107, 32, 98, 114, 111, 119, 110, 32, 102, 111, 7, 13, 10, 72, 111, 115, 116, 58, 32, 108, 111, 99, 97, 108, 104, 111, 115, 116, 58, 56, 48, 48, 48, 13, 10, 85, 115, 101, 114, 45, 65, 103, 101, 110, 116, 58, 32, 119, 105, 110, 103, 102, 117, 122, 122, 13, 10, 13, 10])
}]
const pcapFile = generator(ipPackets)

fs.writeFileSync('test.pcap', pcapFile)
console.log('Open test.pcap in Wireshark')